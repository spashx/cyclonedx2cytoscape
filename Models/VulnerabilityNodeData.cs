using Newtonsoft.Json;

namespace Cdx2Cyto.Models;

/// <summary>
/// Node data representing a vulnerability (e.g., CVE) associated with a component.
/// </summary>
public class VulnerabilityNodeData : CytoscapeNodeData
{
    public VulnerabilityNodeData()
    {
        Class = "vulnerability";
    }

    /// <summary>
    /// Vulnerability score (e.g., CVSS base score).
    /// </summary>
    [JsonProperty("score")]
    public double? Score { get; set; }

    /// <summary>
    /// Severity label (e.g., critical, high, medium, low, none).
    /// </summary>
    [JsonProperty("severity")]
    public string Severity { get; set; } = "";

    /// <summary>
    /// Reference URL for additional vulnerability details.
    /// </summary>
    [JsonProperty("source_url")]
    public string SourceUrl { get; set; } = "";

    /// <summary>
    /// Scoring method used (e.g., CVSSv3, CVSSv2) as provided in the SBOM rating object.
    /// </summary>
    [JsonProperty("method")]
    public string Method { get; set; } = "";

    /// <summary>
    /// Scoring vector string (e.g., CVSS vector string) describing metric values.
    /// </summary>
    [JsonProperty("vector")]
    public string Vector { get; set; } = "";

    /// <summary>
    /// Name of the rating source (e.g., NVD) providing the score/severity.
    /// </summary>
    [JsonProperty("source_name")]
    public string SourceName { get; set; } = "";
}
